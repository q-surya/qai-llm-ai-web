(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[457],{2751:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var o=r(2115),s=r(4386);let i=()=>{let e=(0,o.useContext)(s.U);if(void 0===e)throw Error("useChat must be used within a ChatProvider");return e}},2842:(e,t,r)=>{Promise.resolve().then(r.bind(r,5154))},4386:(e,t,r)=>{"use strict";r.d(t,{U:()=>n,k:()=>c});var o=r(5155),s=r(2115),i=r(9675);let l="/api",a=async e=>{try{console.log("Sending request to API:",{query:e});let t={query:e},r=JSON.stringify(t);console.log("Payload object:",t),console.log("Payload stringified:",r),console.log("Request URL:","".concat(l,"/ai-assistant"));let o=await fetch("".concat(l,"/ai-assistant"),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:r});if(console.log("Response status:",o.status),!o.ok){let e=await o.text();throw console.error("API error response:",e),Error("API call failed with status: ".concat(o.status," - ").concat(e))}let s=await o.json();return console.log("API response data:",s),s}catch(e){throw console.error("Error sending message to AI:",e),e}},n=(0,s.createContext)(void 0),d="quantara_chat_history",c=e=>{let{children:t}=e,[r,l]=(0,s.useState)(()=>{let e=localStorage.getItem(d);return e?JSON.parse(e):[]}),[c,x]=(0,s.useState)(!1),[u,h]=(0,s.useState)(null);(0,s.useEffect)(()=>{localStorage.setItem(d,JSON.stringify(r))},[r]);let p=async e=>{x(!0),h(null);let t={id:(0,i.A)(),role:"user",content:e,timestamp:Date.now()};l(e=>[...e,t]);try{let t=await a(e);console.log("API Response received:",t);let r={id:(0,i.A)(),role:"ai",content:t.answer||"Received response but 'answer' field was empty. Click for details.",timestamp:Date.now(),apiResponse:t};l(e=>[...e,r])}catch(e){h(e instanceof Error?e.message:"An unknown error occurred")}finally{x(!1)}};return(0,o.jsx)(n.Provider,{value:{messages:r,isLoading:c,error:u,sendMessage:p,clearHistory:()=>{l([]),localStorage.removeItem(d)}},children:t})}},5154:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>f});var o=r(5155),s=r(2115),i=r(1574),l=r(9488),a=r(3719),n=r(8638),d=r(2751),c=r(63);let x=e=>{let{message:t}=e,r=(0,c.useRouter)(),s="user"===t.role,a="ai"===t.role;return(0,o.jsx)(i.A,{display:"flex",justifyContent:s?"flex-end":"flex-start",mb:3,sx:{width:"100%"},children:(0,o.jsxs)(i.A,{onClick:()=>{a&&t.apiResponse&&r.push("/details/".concat(t.id))},sx:{maxWidth:{xs:"85%",sm:"80%"},px:{xs:2.5,md:3},py:{xs:1.5,md:2},borderRadius:"1.5rem",bgcolor:s?"#6D5CFF":"#1E0C34",color:"#F2ECF8",fontSize:{xs:"0.95rem",md:"1rem"},lineHeight:1.6,boxShadow:"0 2px 5px rgba(0,0,0,0.2)",border:a?"1px solid":"none",borderColor:a?"#2B1348":"transparent",cursor:a?"pointer":"default",transition:"all 0.2s ease","&:hover":a?{bgcolor:"#2B1348",transform:"translateY(-1px)"}:{}},children:[(0,o.jsx)(l.A,{variant:"body1",sx:{whiteSpace:"pre-wrap",wordBreak:"break-word",color:"#F2ECF8"},children:t.content}),a&&(0,o.jsx)(l.A,{variant:"caption",display:"block",sx:{mt:1.5,color:"#A090B0",fontSize:"0.75rem",fontStyle:"italic"},children:"\uD83D\uDCA1 Click to view SQL details"})]})})};var u=r(2042),h=r(4288),p=r(4619);let m=e=>{let{onSend:t,isLoading:r}=e,[l,a]=(0,s.useState)(""),n=()=>{l.trim()&&!r&&(t(l.trim()),a(""))};return(0,o.jsxs)(i.A,{sx:{width:"100%",pt:2,pb:3,display:"flex",flexDirection:"column",alignItems:"center"},children:[(0,o.jsxs)(i.A,{sx:{position:"relative",width:"100%"},children:[(0,o.jsx)(u.A,{fullWidth:!0,placeholder:"Message Quantara...",multiline:!0,maxRows:1,value:l,onChange:e=>a(e.target.value),onKeyDown:e=>{"Enter"!==e.key||e.shiftKey||(e.preventDefault(),n())},disabled:r,variant:"outlined",sx:{"& .MuiOutlinedInput-root":{bgcolor:"#1E0C34",borderRadius:"30px",color:"#F2ECF8",pl:3,pr:7,height:"56px",alignItems:"center","& fieldset":{borderColor:"#2B1348"},"&:hover fieldset":{borderColor:"#6D5CFF"},"&.Mui-focused fieldset":{borderColor:"#6D5CFF",borderWidth:"1px"}}},inputProps:{style:{padding:0}}}),(0,o.jsx)(i.A,{sx:{position:"absolute",right:8,top:"50%",transform:"translateY(-50%)",zIndex:2},children:(0,o.jsx)(h.A,{onClick:n,disabled:!l.trim()||r,sx:{background:l.trim()?"linear-gradient(135deg, #6D5CFF 0%, #B44BFF 100%)":"#2B1348",color:"#F2ECF8",width:"36px",height:"36px",opacity:l.trim()?1:.5,"&:hover":{background:l.trim()?"linear-gradient(135deg, #5844E0 0%, #9F33E6 100%)":"#2B1348"},transition:"all 0.2s"},children:(0,o.jsx)(p.A,{fontSize:"small"})})})]}),(0,o.jsx)(i.A,{sx:{mt:1.5,textAlign:"center",px:2},children:(0,o.jsx)(i.A,{component:"span",sx:{fontSize:"0.75rem",color:"#A090B0",display:"block"},children:"Quantara can make mistakes. Consider checking important information."})})]})};function f(){let{messages:e,isLoading:t,sendMessage:r}=(0,d.A)(),c=(0,s.useRef)(null);return(0,s.useEffect)(()=>{var e;null==(e=c.current)||e.scrollIntoView({behavior:"smooth"})},[e]),(0,o.jsxs)(i.A,{sx:{height:"100vh",width:"100%",bgcolor:"background.default",display:"flex",flexDirection:"column"},children:[(0,o.jsx)(i.A,{sx:{py:2,borderBottom:"1px solid",borderColor:"divider",textAlign:"center",bgcolor:"background.default",zIndex:10},children:(0,o.jsx)(l.A,{variant:"h6",fontWeight:600,color:"text.primary",children:"Quantara AI"})}),(0,o.jsx)(i.A,{sx:{flexGrow:1,overflow:"hidden",display:"flex",flexDirection:"column",alignItems:"center",width:"100%"},children:(0,o.jsxs)(a.A,{maxWidth:!1,sx:{maxWidth:{xs:"100%",md:"800px",lg:"900px"},width:"100%",height:"100%",display:"flex",flexDirection:"column",px:{xs:2,md:0}},children:[(0,o.jsxs)(i.A,{sx:{flexGrow:1,overflowY:"auto",width:"100%",pt:{xs:2,md:4},pb:2,scrollbarWidth:"thin","&::-webkit-scrollbar":{width:"6px"},"&::-webkit-scrollbar-thumb":{backgroundColor:"divider",borderRadius:"3px"}},children:[0===e.length?(0,o.jsxs)(i.A,{sx:{mt:{xs:6,md:10},textAlign:"center",opacity:.7,px:2},children:[(0,o.jsx)(l.A,{variant:"h4",fontWeight:"bold",gutterBottom:!0,sx:{fontSize:{xs:"1.5rem",md:"2rem"}},children:"How can I help you today?"}),(0,o.jsx)(l.A,{variant:"body1",color:"text.secondary",sx:{mt:2},children:"Ask me anything about your data"})]}):e.map(e=>(0,o.jsx)(x,{message:e},e.id)),t&&(0,o.jsx)(i.A,{sx:{display:"flex",justifyContent:"flex-start",mb:2},children:(0,o.jsx)(i.A,{sx:{bgcolor:"background.paper",p:2,borderRadius:2,border:"1px solid",borderColor:"#2B1348"},children:(0,o.jsx)(n.A,{size:20,sx:{color:"primary.main"}})})}),(0,o.jsx)("div",{ref:c})]}),(0,o.jsx)(m,{onSend:r,isLoading:t})]})})]})}}},e=>{e.O(0,[263,608,85,441,255,358],()=>e(e.s=2842)),_N_E=e.O()}]);