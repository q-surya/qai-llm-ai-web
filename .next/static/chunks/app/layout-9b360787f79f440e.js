(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[177],{2610:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>i});var o=r(5155);r(2115);var s=r(7533),a=r(9869),l=r(4386);let n=(0,r(2691).A)({palette:{mode:"dark",primary:{main:"#6D5CFF",contrastText:"#F2ECF8"},secondary:{main:"#B44BFF"},background:{default:"#12081F",paper:"#1E0C34"},text:{primary:"#F2ECF8",secondary:"#A090B0"},divider:"#2B1348"},typography:{fontFamily:'"Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif',body1:{lineHeight:1.7,fontSize:"1rem",color:"#F2ECF8"},h4:{color:"#F2ECF8"},h6:{color:"#F2ECF8"}},components:{MuiCssBaseline:{styleOverrides:{body:{backgroundColor:"#12081F",color:"#F2ECF8",overflow:"hidden",height:"100%"},html:{overflow:"hidden",height:"100%"}}}},breakpoints:{values:{xs:0,sm:640,md:768,lg:1024,xl:1280}}});function i(e){let{children:t}=e;return(0,o.jsx)("html",{lang:"en",style:{overflow:"hidden",height:"100%"},children:(0,o.jsx)("body",{style:{overflow:"hidden",height:"100%",margin:0},children:(0,o.jsxs)(s.A,{theme:n,children:[(0,o.jsx)(a.Ay,{}),(0,o.jsx)(l.k,{children:t})]})})})}},3562:(e,t,r)=>{Promise.resolve().then(r.bind(r,2610))},4386:(e,t,r)=>{"use strict";r.d(t,{U:()=>i,k:()=>d});var o=r(5155),s=r(2115),a=r(9675);let l="/api",n=async function(e){let t=!(arguments.length>1)||void 0===arguments[1]||arguments[1],r=arguments.length>2?arguments[2]:void 0;try{console.log("Sending request to API:",{query:e,streaming:t});let o={query:e,streaming:t},s=JSON.stringify(o);console.log("Payload object:",o),console.log("Request URL:","".concat(l,"/ai-assistant"));let a=await fetch("".concat(l,"/ai-assistant"),{method:"POST",headers:{"Content-Type":"application/json",Accept:t?"text/event-stream":"application/json"},body:s});if(console.log("Response status:",a.status),!a.ok){let e=await a.text();throw console.error("API error response:",e),Error("API call failed with status: ".concat(a.status," - ").concat(e))}if(t&&a.body){let e=a.body.getReader(),t=new TextDecoder,o="",s="";for(;;){let{done:a,value:l}=await e.read();if(a)break;let n=t.decode(l,{stream:!0});if(o+=n,r)try{let e=o.indexOf('"answer"');if(-1!==e){let t=o.indexOf('"',e+8)+1;if(t>0){let e="",a=t,l=!1;for(;a<o.length;){let t=o[a];if(l)"n"===t?e+="\n":"t"===t?e+="	":"r"===t?e+="\r":e+=t,l=!1;else if("\\"===t)l=!0;else if('"'===t)break;else e+=t;a++}if(e.length>s.length){let t=e.slice(s.length);s=e,r(t)}}else r("")}else r(n)}catch(e){r(n)}}try{let e=JSON.parse(o.trim());return console.log("API response data:",e),e}catch(t){let e=o.match(/\{[\s\S]*\}/);if(e)try{let t=JSON.parse(e[0]);return console.log("API response data (extracted):",t),t}catch(e){}return{is_query_generated:!1,sql_query:"",sql_prompt:"",answer:o.trim()}}}{let e=await a.json();return console.log("API response data:",e),e}}catch(e){throw console.error("Error sending message to AI:",e),e}},i=(0,s.createContext)(void 0),c="quantara_chat_history",d=e=>{let{children:t}=e,[r,l]=(0,s.useState)([]),[d,h]=(0,s.useState)(!1),[u,f]=(0,s.useState)(null),[p,g]=(0,s.useState)(!1);(0,s.useEffect)(()=>{{let e=localStorage.getItem(c);if(e)try{l(JSON.parse(e))}catch(e){console.error("Failed to parse saved messages:",e)}g(!0)}},[]),(0,s.useEffect)(()=>{p&&localStorage.setItem(c,JSON.stringify(r))},[r,p]);let y=async e=>{h(!0),f(null);let t={id:(0,a.A)(),role:"user",content:e,timestamp:Date.now()};l(e=>[...e,t]);try{let t=await n(e,!1);console.log("API Response received:",t);let r={id:(0,a.A)(),role:"ai",content:t.answer||"Received response but 'answer' field was empty. Click for details.",timestamp:Date.now(),apiResponse:t};l(e=>[...e,r])}catch(e){f(e instanceof Error?e.message:"An unknown error occurred")}finally{h(!1)}};return(0,o.jsx)(i.Provider,{value:{messages:r,isLoading:d,error:u,sendMessage:y,clearHistory:()=>{l([]),localStorage.removeItem(c)}},children:t})}}},e=>{e.O(0,[263,331,441,255,358],()=>e(e.s=3562)),_N_E=e.O()}]);